<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>å—ä¿¡ãƒ‡ãƒ¼ã‚¿ä¸€è¦§</title>
<style>
  body{
    margin:0;
    min-height:100vh;
    display:grid;
    place-items:center;
    background:#f4f6fb;
    font-family: system-ui, -apple-system, "Noto Sans JP", sans-serif;
    color:#333;
  }
  .card{
    width:min(96vw, 900px);
    background:#fff;
    border-radius:14px;
    padding:20px;
    box-shadow:0 20px 40px rgba(0,0,0,.1);
  }
  h1{ margin:0 0 14px; font-size:18px; }
  .note{ font-size:12px; color:#777; margin-bottom:12px; }

  table{
    width:100%;
    border-collapse:collapse;
    font-size:14px;
  }
  th, td{
    padding:10px;
    border-bottom:1px solid #e5e7eb;
    text-align:left;
    white-space:nowrap;
  }
  th{ background:#f8fafc; font-weight:600; }
  tr:hover td{ background:#fafcff; }

  button{
    border:none;
    border-radius:8px;
    padding:6px 10px;
    cursor:pointer;
    font-size:12px;
  }
  .del{ background:#ffe3e3; color:#c92a2a; }
  .clear{ background:#e7f0ff; color:#1c5cff; margin-bottom:10px; }

  .empty{
    text-align:center;
    color:#888;
    padding:20px 0;
  }
</style>
</head>
<body>

<div class="card">
  <h1>ğŸ“¥ å—ä¿¡ãƒ‡ãƒ¼ã‚¿ä¸€è¦§</h1>
  <div class="note">
    â€» https://login-password-810.github.io/username.github.io/ã‹ã‚‰å—ä¿¡ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ãƒ»è¡¨ç¤ºã—ã¦ã„ã¾ã™
  </div>

  <button class="clear" id="clearAll">ã™ã¹ã¦å‰Šé™¤</button>

  <table id="table">
    <thead>
      <tr>
        <th>å—ä¿¡æ™‚åˆ»</th>
        <th>ãƒ¡ãƒ¼ãƒ«</th>
        <th>ç¾åœ¨åœ°</th>
        <th>é›»è©±ç•ªå·</th>
        <th>æ“ä½œ</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="empty" id="emptyMsg">ã¾ã å—ä¿¡ãƒ‡ãƒ¼ã‚¿ã¯ã‚ã‚Šã¾ã›ã‚“</div>
</div>

<script>
/* ---------- è¨­å®š ---------- */
const STORAGE_KEY = "received_demo_data";

/* ---------- URLã‹ã‚‰æ–°è¦å—ä¿¡ ---------- */
const params = new URLSearchParams(location.search);
const email   = params.get("email");
const address = params.get("address");
const phone   = params.get("phone");

if (email || address || phone) {
  const list = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

  list.push({
    id: Date.now(),
    time: new Date().toLocaleString(),
    email: email || "",
    address: address || "",
    phone: phone || ""
  });

  localStorage.setItem(STORAGE_KEY, JSON.stringify(list));

  // URLã‚’ãã‚Œã„ã«ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã«äºŒé‡ç™»éŒ²é˜²æ­¢ï¼‰
  history.replaceState(null, "", location.pathname);
}

/* ---------- è¡¨ç¤ºå‡¦ç† ---------- */
function render() {
  const tbody = document.querySelector("#table tbody");
  const empty = document.getElementById("emptyMsg");
  const list = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

  tbody.innerHTML = "";

  if (list.length === 0) {
    empty.style.display = "block";
    return;
  }

  empty.style.display = "none";

  list.forEach(item => {
    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${item.time}</td>
      <td>${item.email}</td>
      <td>${item.address}</td>
      <td>${item.phone}</td>
      <td>
        <button class="del" data-id="${item.id}">å‰Šé™¤</button>
      </td>
    `;

    tbody.appendChild(tr);
  });
}

/* ---------- å‰Šé™¤ï¼ˆ1ä»¶ï¼‰ ---------- */
document.addEventListener("click", e => {
  if (!e.target.classList.contains("del")) return;

  const id = Number(e.target.dataset.id);
  let list = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
  list = list.filter(item => item.id !== id);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
  render();
});

/* ---------- å…¨å‰Šé™¤ ---------- */
document.getElementById("clearAll").addEventListener("click", () => {
  if (!confirm("ã™ã¹ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;
  localStorage.removeItem(STORAGE_KEY);
  render();
});

/* åˆæœŸè¡¨ç¤º */
render();
</script>

</body>
</html>
